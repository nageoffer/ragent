# OA 系统数据安全规范

---

## 1. 总览与目标

OA 系统承载人事、审批、行政、财务、公文与档案等关键业务数据，数据类型多、敏感度跨度大、访问链路长、集成对象多，因此数据安全的核心就是“在合规的前提下把正确的数据在正确的时间交到正确的人手中，并留下可审计的证据”。本规范以数据全生命周期为主线，明确“身份可信、访问可控、传输加密、存储防护、操作可审、风险可控、故障可恢复”的建设目标，并将要求固化为可执行的策略与可验证的工单/脚本/配置，确保安全能力“可部署、可度量、可复盘”。

**关键目标**

* 将 **最小权限** 与 **按需可见** 落到行级/字段级/附件级别。
* 以 **统一身份**、**多因子认证** 与 **账号生命周期** 管控入口风险。
* 以 **分级加密**、**密钥治理** 和 **传输加密** 构筑数据壁垒。
* 通过 **全量审计**、**DLP** 与 **行为分析** 实现可追溯与可告警。
* 用 **备份/容灾/演练** 保证“出事可恢复”，用 **指标** 驱动持续改进。

---

## 2. 适用范围与对象

本规范适用于 OA 的平台层、业务模块与集成接口，覆盖研发、测试、运维、HR、行政、财务、内审与安全团队；同时适用于外包与第三方集成场景，其合同与对接文档应纳入本规范的强制条款范围。

---

## 3. 名词与数据对象

为避免理解歧义，对常见对象给出统一口径：

* **敏感数据**：身份信息、联系方式、薪酬、合同、票据、证件影像、审批附件等。
* **高敏数据**：薪酬总额、个人税务、合同价格、银行账户、证件正反面扫描件等。
* **数据标签**：对记录/字段/附件的“机读级别标记”，与策略引擎直接关联。
* **策略引擎**：基于 RBAC+ABAC 的授权裁决与 DLP 检测执行组件。

---

## 4. 架构与治理原则

OA 安全是纵深防御工程：
**入口可信**（统一认证/MFA/设备指纹）→ **权限裁决**（角色+属性+实时风险）→ **数据壁垒**（加密/脱敏/下载限制）→ **过程可审**（操作日志/变更日志）→ **异常处置**（检测/隔离/响应/复盘）→ **恢复韧性**（备份/演练/指标化改进）。

**治理原则**

* **制度即代码**：制度落到策略，策略固化为配置/脚本/规则，避免“纸面合规”。
* **默认安全**：默认拒绝、按需放行、到期回收、长期复核，避免“遗留权限”。
* **最小暴露**：能看≠能下载，能下载≠可外传；水印与溯源默认开启。
* **证据闭环**：关键操作、策略版本、密钥访问、接口调用均可追溯。

---

## 5. 数据分类分级与标签化

先统一口径再配置策略，以“分级+标签”驱动后续所有技术与流程动作。
**等级建议**

* **L1 公开/内部**：公告、流程模板名；仅基础访问控制。
* **L2 一般敏感**：行政与审批过程数据；需认证+授权+基本审计。
* **L3 敏感**：人事信息、财务凭证、合同文本；需细粒度授权+加密存储+审计。
* **L4 高敏**：薪酬要素、银行账户、证件影像；需强制加密+下载限制+双重审批+强审计。

**实施要点**

* 以 **字段/附件** 为颗粒度贴标，自动继承到记录与导出物；
* 策略引擎按 **标签→策略** 映射执行脱敏、下载限制、水印、审批等动作；
* 元数据存入专用表，变更有版本号与审计记录，避免执行漂移。

---

## 6. 身份认证与账号生命周期

**认证要求**

* 统一身份源（SSO/OIDC/LDAP/AD），对高敏模块启用 **MFA**。
* 会话采用短期 **Access Token + Refresh Token**，与设备/IP/地理位置绑定；异常跃迁需二次验证。

**生命周期**

* **入职**：自动建号与基础角色绑定；
* **调岗**：触发权限重算与“旧域回收”；
* **离职**：即时停用账号、吊销 Token、回收第三方密钥与共享资源；
* **特权账号**：更高口令强度、更严登录告警、更细操作审计、强行权分离。

**弱口令治理**

* 8–12 位含多类字符、90 天更新、历史 5 次不可复用，密码错误 N 次锁定并告警。

---

## 7. 访问控制（RBAC + ABAC）与细粒度授权

**模型设计**

* 用 **RBAC** 定义员工/主管/HR/财务/行政/系统管理员的“岗位权限包”；
* 用 **ABAC** 引入组织路径、地域、流程节点、字段等级、设备可信度、访问时段与实时风险分值进行动态裁决。

**细粒度实践**

* **行级**：仅本部门可见；主管可见本部门及下属部门；跨域需审批与强审计；
* **字段级**：金额/联系方式/证件号按“可见/模糊/不可见”三态策略；
* **附件级**：区分预览与下载，下载需审批；水印包含账号、时间戳、来源单号与校验码；
* **会话关联**：权限变更即时生效，对已建立会话设“短宽限 + 强提醒”。

**典型策略示例**

* “薪酬字段仅 HR 可见，主管仅见区间值，员工只见本人明细”；
* “高敏附件默认仅预览，下载需二审，且链接一次一签一次一用”。

---

## 8. 存储安全与密钥治理

**加密与分层**

* 敏感字段采用 **AES-256/TDE**，附件加密存储，URL 统一签名并设有效期；
* 重要库表分权访问，仅白名单服务进程可读写；生产只读账号不允许写操作。

**密钥治理**

* 密钥不随代码与镜像发布，放入 **KMS/HSM**；
* 以工单驱动 **密钥轮转**，访问日志需全留存与审计；
* 对缓存（如 Redis）设敏感数据禁存清单或强制加密白名单，控制 TTL 与授权范围。

**脱敏展现**

* 默认脱敏，明文需说明理由并走审批；
* 脱敏规则版本化，渗透测试与内审覆盖高风险页面与导出接口。

---

## 9. 传输安全与接口防护

**传输加密**

* 全站 **TLS 1.2+**，禁明文与弱套件；高敏参数二次加密或签名校验；
* WebSocket 仅在 WSS 下运行并与会话强绑定。

**接口治理**

* API 网关统一鉴权、限流、黑白名单与风控打分；
* HMAC/JWT/OAuth2 客户端凭据按场景分级使用；
* 防重放（时间戳+Nonce）、防暴力（限频+封禁）、防越权（路径与资源级校验）；
* 对第三方回调设白名单与“回源校验”，严禁公网直透内网服务。

---

## 10. 日志审计与行为分析

**审计范围**

* 登录与认证、数据查看与修改、审批与退回、导出与下载、权限变更、密钥访问、接口调用与回调。

**记录要素**

* 用户与组织、会话标识、设备/IP/地理位置、请求上下文、目标数据标签与策略版本、结果与错误码、延迟与数据量。

**留存与合规**

* 一般访问日志 ≥ 180 天；管理员与财务类 ≥ 1–3 年（按内控要求）；
* 审计系统只增不改，提供可校验证据链导出能力。

**行为分析**

* 以基线建模检测“深夜集中下载、短时遍历高敏记录、频繁失败登录、跨地域快速切换、异常 Token 复用”等模式，按 S1/S2/S3 触发分级响应。

---

## 11. 备份、容灾与演练

**策略建议**

* 日全量、2 小时增量、周冷备、月跨地域；
* 备份加密、独立账号访问、定期恢复演练；
* 明确 **RPO ≤ 10 分钟、RTO ≤ 2 小时**（示例值，可按业务调整）。

**工程化**

* 备份/恢复脚本化、参数化，纳入巡检；
* 恢复演练出报告，覆盖“库+对象存储+配置中心”，确保“会演练也能实战”。

---

## 12. DLP、导出治理与水印追踪

**导出前置**

* 申请说明用途、范围、保存期限与责任人，高敏默认二审；
* 按量、按时段限流，导出文件统一压签加密，下载链接一次一签。

**水印与溯源**

* 预览与导出文件叠加可追踪水印（账号/时间/来源单/哈希），截图类采用动态水印；
* 违规传播可快速定位责任主体与泄露链路。

**移动端约束**

* 原则上禁止高敏离线落地，确需落地使用系统级安全区与强加密封装，支持远程擦除。

---

## 13. 移动端与零信任外部接入

**设备与会话**

* 设备指纹、Root/Jailbreak 检测、系统版本合规校验，不合规降级或拒绝；
* Token 与设备/IP 绑定，异常跃迁触发强验证。

**零信任网关**

* 统一入口（反向代理/API 网关），按身份、设备态、地理位置与实时风险分值动态裁决；
* 外协与合作伙伴使用独立租户或隔离角色域，避免共享内部角色导致权限外溢。

---

## 14. 安全事件分级、响应与复盘

**分级示例**

* **S1**：大规模高敏泄露、核心密钥泄露、系统被控；
* **S2**：批量异常导出、越权读取敏感数据；
* **S3**：暴力破解、异常设备登录；
* **S4**：低风险告警与策略误触发。

**响应流程**

* 发现→确认→隔离会话/吊销密钥→限权/熔断→调查取证→修复加固→复盘报告→策略更新。
* 事后出具“时间线、根因、影响面、证据链、修复项、防复发措施”，并纳入审计抽查。

---

## 15. 合规与审计协同

以“数据最小化、用途限定、保存期限、访问可审”为基本原则，结合企业现行内控要求，完成制度条款→策略配置→日志校验的全链路闭环；内外部审计应能抽取“策略快照、审计样例、导出审批记录、恢复演练报告、事件复盘材料”，做到“说得清、拿得出、验得准”。

---

## 16. 风险场景与处置示例

**场景 A：员工可见非本部门审批单**

* **根因**：组织路径未校验或缓存旧权限。
* **处置**：行级权限绑定组织树；权限变更推送会话；历史会话短宽限后失效；抽检审计。

**场景 B：管理员批量导出薪酬附件**

* **根因**：导出默认放行，缺少审批与限流。
* **处置**：高敏导出二审与按量限流；水印与一次一签；审计必留存并做 UEBA 复核。

**场景 C：离职账号未回收造成外泄**

* **根因**：人事事件与账号回收未打通，第三方密钥忘记吊销。
* **处置**：HR 工单驱动自动化回收与密钥吊销；离职清单核验；定期复盘漏回收项。

**场景 D：附件外链被爬取**

* **根因**：对象存储直链暴露，缺少签名与防盗链。
* **处置**：统一签名、有效期与 Referer 校验；私有桶+回源鉴权；异常请求封禁。

---

## 17. 落地路线图与度量指标

**三阶段路径**

* **基线期（0–1 个月）**：统一认证+MFA、TLS 全站、RBAC 基线、审计全开、关键库加密、对象存储签名化；
* **强化期（1–3 个月）**：数据标签化、ABAC 动态授权、导出审批+水印+限流、密钥上 KMS、UEBA/风控评分；
* **稳态期（3–6 个月）**：恢复演练常态化、指标看板化、权限周期复核、渗透与攻防演练、外协租户隔离。

**核心指标（示例）**

* 离职权限回收时延（P95）≤ 10 分钟；
* 高敏导出审批通过率与平均处理时长；
* 高敏字段“明文查看”申请转化为“脱敏查看”的比例；
* 异常行为发现到处置闭环时长（S1/S2）；
* 备份恢复演练成功率与平均恢复时长；
* 漏洞修复平均周期、策略命中误报/漏报率。

---

## 18. 附录（样例）

**权限矩阵（节选）**

| 角色  | 本部门数据 | 下属部门 | 高敏字段 | 高敏导出   | 管理操作      |
| --- | ----- | ---- | ---- | ------ | --------- |
| 员工  | ✔（本人） | ✖    | ✖/模糊 | ✖      | ✖         |
| 主管  | ✔     | ✔    | 模糊   | 申请后视审批 | ✖         |
| HR  | ✔     | ✔    | ✔    | 二审+限流  | ✖         |
| 财务  | 相关流程  | 相关流程 | 金额可见 | 二审+限流  | ✖         |
| 管理员 | 依职责   | 依职责  | 依职责  | 二审+限流  | 部分 ✔（强审计） |

**审计字段（示例 JSON）**

```json
{
  "userId":"u_12345",
  "orgPath":"1/12/129",
  "sessionId":"s_abcd",
  "action":"EXPORT_ATTACHMENT",
  "resource":"approval#9966",
  "labels":["L4","HR_PAYROLL"],
  "policyVersion":"p_2025_11_01",
  "client":"Chrome 122 / macOS",
  "ip":"10.0.12.7",
  "geo":"CN-HZ",
  "ts":"2025-11-26T10:23:44Z",
  "result":"ALLOW_WITH_APPROVAL",
  "extra":{"count":120,"watermark":"u_12345|2025-11-26|9966"}
}
```

---

## 结语

本规范以“标签化数据、策略化执行、指标化运营、脚本化恢复”为主轴，将抽象原则拆解为可实施的工程动作与可量化的治理目标；在实践中，应坚持“默认安全、最小暴露、强制审计、持续演练”的底线思维，并以清单化工单与自动化策略确保“人来即授、人走即回、权限随岗、证据随行”，让 OA 系统在复杂组织与多端接入下依然可控、可依、可证、可复。
